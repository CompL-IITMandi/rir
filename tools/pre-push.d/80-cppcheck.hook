#!/bin/bash -m

ROOT=$1

which cppcheck &> /dev/null

if [[ $? -ne 0 ]]; then
  echo "cppcheck not found!"
  echo " consider installing it."
  exit 0
fi

echo "This might take a while, ctl-c to skip:"

# set SIGINT to default action
trap - INT

CORES=`nproc 2> /dev/null || echo 8`
# Run the command in background
bash -c "$ROOT/tools/cppcheck -j$CORES" &

# Set our signal mask to ignore SIGINT
trap "" INT

# Move the command back-into foreground
fg %-
